This script was created for use as an azure function. It is triggered by power automate flow which makes an http request and passes a bid identifier and optional version number provided by the user with the triggering request.
The function calls an api with that information and creates class objects based on the response. It also interacts with a sql database to add additional data not available soley from the api response. It then creates a csv file in memory and uploads it to blob storage. The flow then moves the csv file to a sharepoint site for consumption by the end user. Uploading to blob storage first was chosen because of difficulties in trying to upload the file directly to sharepoint. The flow deletes the file uploaded to blob storage once the transfer to the sharepoint site is completed.
